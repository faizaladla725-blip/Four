<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JKT48 HUB â€” Masterpiece</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;800&family=Syne:wght@700;800&display=swap" rel="stylesheet">
    <style>
        :root { 
            --accent: #ff004c; 
            --bg: #030303; 
            --text: #ffffff;
            --glass: rgba(255, 255, 255, 0.03);
            --border: rgba(255, 255, 255, 0.07);
        }

        .light-mode {
            --bg: #f8f9fa;
            --text: #1a1a1a;
            --glass: rgba(0, 0, 0, 0.02);
            --border: rgba(0, 0, 0, 0.08);
        }

        body { 
            font-family: 'Outfit', sans-serif; 
            background-color: var(--bg); 
            color: var(--text);
            transition: background-color 0.5s, color 0.5s;
            min-height: 100vh;
        }

        .syne { font-family: 'Syne', sans-serif; }

        .glass-card {
            background: var(--glass);
            backdrop-filter: blur(15px);
            border: 1px solid var(--border);
            transition: all 0.4s cubic-bezier(0.23, 1, 0.32, 1);
        }

        .light-mode .glass-card { box-shadow: 0 10px 30px rgba(0,0,0,0.03); }

        /* Theater Mode */
        #theater-overlay {
            display: none;
            position: fixed;
            inset: 0;
            z-index: 9999;
            background: rgba(0,0,0,0.98);
        }

        .theme-toggle {
            cursor: pointer;
            width: 45px;
            height: 45px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 15px;
            background: var(--glass);
            border: 1px solid var(--border);
        }

        .btn-main {
            background: var(--accent);
            color: white;
            transition: all 0.3s;
        }
        .btn-main:hover {
            box-shadow: 0 0 25px var(--accent);
            transform: translateY(-2px);
        }
    </style>
</head>
<body class="overflow-x-hidden">

    <div id="theater-overlay">
        <div class="p-6 flex justify-between items-center">
            <h2 class="syne text-white text-xl uppercase italic">Theater Stage</h2>
            <button onclick="exitTheater()" class="bg-rose-600 px-8 py-2 rounded-full text-[10px] font-black text-white">EXIT THEATER</button>
        </div>
        <div id="stage-grid" class="grid grid-cols-1 md:grid-cols-2 gap-4 h-[80vh] p-6">
            <div class="rounded-[2rem] overflow-hidden bg-black"><iframe id="p-1" class="w-full h-full"></iframe></div>
            <div id="s-2" class="rounded-[2rem] overflow-hidden bg-black hidden"><iframe id="p-2" class="w-full h-full"></iframe></div>
        </div>
    </div>

    <nav class="max-w-7xl mx-auto p-8 flex justify-between items-center">
        <div class="syne text-3xl font-extrabold italic tracking-tighter uppercase">
            JKT<span class="text-rose-600">HUB</span>
        </div>
        <div class="flex gap-4">
            <div onclick="toggleTheme()" class="theme-toggle">
                <span id="theme-icon" class="text-xl">ðŸŒ“</span>
            </div>
            <div id="bday-badge" class="hidden items-center gap-2 bg-rose-600 text-white px-5 py-2 rounded-2xl text-[10px] font-black uppercase shadow-lg shadow-rose-600/20">
                ðŸŽ‰ HBD FENI!
            </div>
        </div>
    </nav>

    <main class="max-w-7xl mx-auto px-8 py-10">
        <div class="grid grid-cols-1 lg:grid-cols-12 gap-12">
            
            <div class="lg:col-span-8">
                <div class="flex items-center justify-between mb-10">
                    <h2 class="syne text-2xl uppercase italic">Members On-Air</h2>
                    <div class="h-1 w-20 bg-rose-600 rounded-full"></div>
                </div>
                <div id="live-container" class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    </div>
            </div>

            <div class="lg:col-span-4 space-y-12">
                <section>
                    <h3 class="syne text-lg mb-6 uppercase italic opacity-50">Headlines</h3>
                    <div id="news-container" class="space-y-4"></div>
                </section>

                <section class="glass-card rounded-[2.5rem] p-8">
                    <h3 class="syne text-lg mb-6 uppercase italic text-rose-600">Schedule</h3>
                    <div id="schedule-container" class="space-y-6"></div>
                </section>
            </div>

        </div>
    </main>

    <script>
        let isDarkMode = true;

        function toggleTheme() {
            isDarkMode = !isDarkMode;
            document.body.classList.toggle('light-mode');
            document.getElementById('theme-icon').innerText = isDarkMode ? 'ðŸŒ“' : 'ðŸŒž';
        }

        async function syncData() {
            try {
                const [live, news, sched] = await Promise.all([
                    fetch('https://api.crstlnz.my.id/api/now_live?group=jkt48'),
                    fetch('https://api.crstlnz.my.id/api/news'),
                    fetch('https://api.crstlnz.my.id/api/schedule')
                ]);

                renderLive(await live.json());
                renderNews(await news.json());
                renderSched(await sched.json());
                
                // Birthday 24 Feb (Feni)
                const today = new Date();
                if(today.getMonth() === 1 && today.getDate() === 24) {
                    document.getElementById('bday-badge').classList.replace('hidden', 'flex');
                }
            } catch (e) { console.log("Re-syncing..."); }
        }

        function renderLive(data) {
            const container = document.getElementById('live-container');
            if(data.length === 0) {
                container.innerHTML = `<div class="col-span-full py-20 text-center glass-card rounded-[3rem] opacity-30 syne">All members are offline</div>`;
                return;
            }
            container.innerHTML = data.map(m => `
                <div class="glass-card rounded-[3rem] overflow-hidden group">
                    <div class="relative aspect-video">
                        <img src="${m.img}" class="w-full h-full object-cover grayscale-[30%] group-hover:grayscale-0 transition-all duration-700">
                        <div class="absolute inset-0 bg-gradient-to-t from-black/80 via-transparent to-transparent"></div>
                        <div class="absolute bottom-6 left-8">
                            <h3 class="syne text-2xl text-white uppercase italic tracking-tighter">${m.name}</h3>
                            <p class="text-[9px] text-rose-500 font-bold tracking-[0.3em] uppercase">${m.type}</p>
                        </div>
                    </div>
                    <div class="p-6 flex gap-3">
                        <button onclick="openStage(1, '${m.room_id}')" class="flex-1 btn-main py-4 rounded-2xl text-[10px] font-black uppercase">Slot 1</button>
                        <button onclick="openStage(2, '${m.room_id}')" class="flex-1 glass-card py-4 rounded-2xl text-[10px] font-black uppercase">Slot 2</button>
                    </div>
                </div>
            `).join('');
        }

        function renderNews(data) {
            document.getElementById('news-container').innerHTML = data.slice(0, 5).map(n => `
                <div class="glass-card p-6 rounded-[2rem] hover:border-rose-600 transition-all cursor-pointer" onclick="window.open('${n.url}', '_blank')">
                    <p class="text-[9px] font-bold text-rose-600 uppercase mb-2">${n.date}</p>
                    <h4 class="text-xs font-bold uppercase leading-relaxed tracking-tight">${n.title}</h4>
                </div>
            `).join('');
        }

        function renderSched(data) {
            document.getElementById('schedule-container').innerHTML = data.slice(0, 4).map(s => `
                <div class="border-l-2 border-rose-600/30 pl-4">
                    <p class="text-[9px] font-bold opacity-30 mb-1">${s.date}</p>
                    <p class="text-[11px] font-black uppercase">${s.title}</p>
                </div>
            `).join('');
        }

        function openStage(slot, roomId) {
            const overlay = document.getElementById('theater-overlay');
            const frame = document.getElementById(`p-${slot}`);
            frame.src = `https://www.showroom-live.com/streaming/embed?room_id=${roomId}`;
            
            if(slot === 2) {
                document.getElementById('s-2').classList.remove('hidden');
                document.getElementById('stage-grid').classList.add('md:grid-cols-2');
            }
            overlay.style.display = 'block';
            document.body.style.overflow = 'hidden';
        }

        function exitTheater() {
            document.getElementById('theater-overlay').style.display = 'none';
            document.getElementById('p-1').src = '';
            document.getElementById('p-2').src = '';
            document.getElementById('s-2').classList.add('hidden');
            document.body.style.overflow = 'auto';
        }

        syncData();
        setInterval(syncData, 60000);
    </script>
</body>
</html>